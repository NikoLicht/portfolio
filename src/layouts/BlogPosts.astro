---
import MainLayout from "./MainLayout.astro";
import GradientBox from "./GradientBox.astro";
// Import all blog posts eagerly
const posts = Object.values(import.meta.glob('../pages/blog/*.md', { eager: true })) as any[];

// Sort posts by date (descending)
posts.sort((a, b) => {
  const dateA = new Date(a.frontmatter.createdAt.split('/').reverse().join('-'));
  const dateB = new Date(b.frontmatter.createdAt.split('/').reverse().join('-'));
  return dateB.getTime() - dateA.getTime();
});
---

<MainLayout>
  <GradientBox showNavigation={true}>
    <div class="blog-list-wrapper">
      {posts.map((post) => (
        <a href={post.url} class="blog-list-item">
          <header class="blog-header">
            <h2>{post.frontmatter.title}</h2>
            <div class="blog-meta">
              <time datetime={post.frontmatter.createdAt}>{post.frontmatter.createdAt}</time>
              {post.frontmatter.tags && (
                <ul class="blog-tags">
                  {post.frontmatter.tags.map((tag: string) => (
                    <li class="blog-tag">{tag}</li>
                  ))}
                </ul>
              )}
            </div>
            {post.frontmatter.shortText && (
              <p class="blog-short-text">{post.frontmatter.shortText}</p>
            )}
          </header>
        </a>
      ))}
    </div>
  </GradientBox>
</MainLayout>

<style>
.blog-list-wrapper {
  padding-left: 20%;
  padding-right: 20%;
  display: flex;
  flex-direction: column;
  gap: 2rem;
  margin-bottom: 3rem;
  margin-top: 3rem;
}

.blog-list-item {
  display: block;
  background: var(--egg-color, #fff);
  border-radius: 1em;
  padding: 2em 2em 1.5em 2em;
  text-decoration: none;
  color: inherit;
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
  transition: background 0.2s;
}
.blog-list-item:hover {
  background: #f5f5f5;
}

.blog-header {
  margin-bottom: 0.5rem;
}

.blog-meta {
  display: flex;
  gap: 1rem;
  align-items: center;
  margin-bottom: 0.5rem;
}

.blog-tags {
  display: flex;
  gap: 0.5rem;
  list-style: none;
  padding: 0;
  margin: 0;
}

.blog-tag {
  background: #eee;
  border-radius: 0.5em;
  padding: 0.2em 0.7em;
  font-size: 0.9em;
}

.blog-short-text {
  font-style: italic;
  color: #666;
  margin-bottom: 0;
}

@media (max-width: 600px) {
  .blog-list-wrapper {
    padding-left: 1rem;
    padding-right: 1rem;
  }
  .blog-list-item {
    padding: 1em 1em 0.7em 1em;
  }
}
</style>
